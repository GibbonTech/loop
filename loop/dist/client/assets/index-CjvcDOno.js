import{r,j as e,L as j}from"./main-BpwBsLkR.js";import{u as y,C as N,a as b}from"./auth-client-_dtl4YQI.js";import{c as n}from"./createLucideIcon-Bw0k3c44.js";import{C as w}from"./clock-DF9_jFTK.js";import{C as v}from"./circle-x-CXjFXDJZ.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],k=n("eye",E);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],C=n("log-out",A);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],R=n("users",D);function O(){var x;const{data:s,isPending:i}=y(),[a,m]=r.useState([]),[h,p]=r.useState(!0),[c,g]=r.useState("all");r.useEffect(()=>{if(!i&&!(s!=null&&s.user)){window.location.href="/login";return}if(!i&&(s!=null&&s.user)&&s.user.role!=="ADMIN"){window.location.href="/espace";return}},[s,i]),r.useEffect(()=>{s!=null&&s.user&&u()},[s]);const u=async()=>{try{const o=await(await fetch("/api/applications")).json();o.success&&m(o.data)}catch(t){console.error("Error fetching applications:",t)}finally{p(!1)}},d=a.filter(t=>c==="all"?!0:t.status===c),l={total:a.length,submitted:a.filter(t=>t.status==="SUBMITTED").length,approved:a.filter(t=>t.status==="APPROVED").length,rejected:a.filter(t=>t.status==="REJECTED").length},f=async()=>{await b(),window.location.href="/login"};return i||h?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-8 w-8 animate-spin rounded-full border-4 border-[#fd521a] border-t-transparent"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"Chargement..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"border-b border-gray-200 bg-white",children:e.jsxs("div",{className:"mx-auto flex h-16 max-w-7xl items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-[#fd521a]"}),e.jsx("span",{className:"text-lg font-bold tracking-tight",children:"LOOP Admin"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm text-gray-500",children:(x=s==null?void 0:s.user)==null?void 0:x.email}),e.jsxs("button",{onClick:f,className:"flex items-center gap-2 rounded-lg px-3 py-2 text-sm text-gray-600 hover:bg-gray-100",children:[e.jsx(C,{className:"h-4 w-4"}),"Déconnexion"]})]})]})}),e.jsxs("main",{className:"mx-auto max-w-7xl px-4 py-8",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold",children:"Tableau de bord"}),e.jsxs("div",{className:"mb-8 grid grid-cols-4 gap-4",children:[e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-blue-100 text-blue-600",children:e.jsx(R,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l.total}),e.jsx("p",{className:"text-sm text-gray-500",children:"Total candidatures"})]})]})}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-amber-100 text-amber-600",children:e.jsx(w,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l.submitted}),e.jsx("p",{className:"text-sm text-gray-500",children:"En attente"})]})]})}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-green-100 text-green-600",children:e.jsx(N,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l.approved}),e.jsx("p",{className:"text-sm text-gray-500",children:"Approuvées"})]})]})}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-red-100 text-red-600",children:e.jsx(v,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l.rejected}),e.jsx("p",{className:"text-sm text-gray-500",children:"Refusées"})]})]})})]}),e.jsx("div",{className:"mb-6 flex gap-2",children:[{id:"all",label:"Toutes"},{id:"SUBMITTED",label:"En attente"},{id:"APPROVED",label:"Approuvées"},{id:"REJECTED",label:"Refusées"}].map(t=>e.jsx("button",{onClick:()=>g(t.id),className:`rounded-lg px-4 py-2 text-sm font-medium transition-colors ${c===t.id?"bg-[#fd521a] text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:t.label},t.id))}),e.jsx("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-gray-200 bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Candidat"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Activité"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"CA Visé"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"Aucune candidature trouvée"})}):d.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:e.jsxs("div",{className:"font-medium text-gray-900",children:[t.firstName," ",t.lastName]})}),e.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.email}),e.jsx("div",{className:"text-sm text-gray-500",children:t.phone})]}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:e.jsx("span",{className:"inline-flex rounded-full bg-gray-100 px-2 py-1 text-xs font-medium text-gray-800",children:t.activityType||"VTC"})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:t.monthlyRevenue||"-"}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-medium ${t.status==="APPROVED"?"bg-green-100 text-green-800":t.status==="REJECTED"?"bg-red-100 text-red-800":"bg-amber-100 text-amber-800"}`,children:t.status==="APPROVED"?"Approuvée":t.status==="REJECTED"?"Refusée":"En attente"})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString("fr-FR")}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right",children:e.jsxs(j,{to:"/admin/applications/$id",params:{id:t.id},className:"inline-flex items-center gap-1 text-sm text-[#fd521a] hover:underline",children:[e.jsx(k,{className:"h-4 w-4"}),"Voir"]})})]},t.id))})]})})]})]})}export{O as component};
